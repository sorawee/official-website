<!DOCTYPE html>
<html lang="th"><head><meta charset="utf-8"/><title>ตามล่าหา Y combinator</title><meta name="author" content="Sorawee Porncharoenwase"/><meta name="keywords" content=""/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="icon" href="https://homes.cs.washington.edu/~sorawee/static/favicon.ico"/><link rel="canonical" href=""/><link rel="stylesheet" type="text/css" href="https://afeld.github.io/emoji-css/emoji.css"/><link rel="stylesheet" type="text/css" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css"/><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Sarabun"/><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Source+Code+Pro"/><link rel="stylesheet" type="text/css" href="https://homes.cs.washington.edu/~sorawee/static/css/app.css"/><link rel="stylesheet" type="text/css" href="https://homes.cs.washington.edu/~sorawee/static/css/pygments.css"/><link rel="alternate" type="application/atom+xml" href="https://homes.cs.washington.edu/~sorawee/th/feed.xml"/></head>
<body><nav class="navbar navbar-expand-md navbar-light bg-light"><div class="container"><div class="navbar-brand site-info">
<h1><a href="https://homes.cs.washington.edu/~sorawee/th/index.html">สรวีย์ พรเจริญวาสน์</a></h1>
<p>PhD Student at UW CSE</p>
</div>
<button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbar_collapse" aria-controls="navbar_collapse" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbar_collapse"><ul class="navbar-nav ml-auto"><li class="nav-item "><a class="nav-link" href="https://homes.cs.washington.edu/~sorawee/th/">หน้าหลัก</a></li>
<li class="nav-item "><a class="nav-link" href="https://homes.cs.washington.edu/~sorawee/th/blog">บล็อก</a></li>
<li class="nav-item "><a class="nav-link" href="https://homes.cs.washington.edu/~sorawee/th/coq-tactics">Coq&#160;Tactics<sup>&lt;α</sup></a></li>
<li class="nav-item"><a class="nav-link" title="sorawee@cs.washington.edu" href="mailto:sorawee@cs.washington.edu" data-toggle="tooltip" data-placement="bottom"><i class="fas fa-envelope"></i></a></li>
<li class="nav-item"><a class="nav-link" title="CSE 394" href="https://norfolk.cs.washington.edu/directory/index.php?prev_floor=3&amp;show_room=CSE394" data-toggle="tooltip" data-placement="bottom"><i class="fas fa-map-marker-alt"></i></a></li>
<li class="nav-item"><a class="nav-link" title="@sorawee" href="https://www.github.com/sorawee" data-toggle="tooltip" data-placement="bottom"><i class="fab fa-github"></i></a></li>
<li class="nav-item"><a class="nav-link" title="Pollen source" href="https://github.com/sorawee/my-website/blob/master/blog/2017/10-05-deriving-Y.html.pm" data-toggle="tooltip" data-placement="bottom"><i class="fas fa-code"></i></a></li>
<li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="fas fa-language"></i></a><div class="dropdown-menu" aria-labelledby="navbarDropdown"><a class="dropdown-item " href="https://homes.cs.washington.edu/~sorawee/en/blog/2017/10-05-deriving-Y.html">อังกฤษ (English)</a><a class="dropdown-item disabled" href="https://homes.cs.washington.edu/~sorawee/th/blog/2017/10-05-deriving-Y.html">ไทย</a></div>
</li>
</ul>
</div>
</div>
</nav>
<main class="container"><div class="row content-type--post">
<div>
<h1>ตามล่าหา Y combinator</h1>
<p>
<p><span class="pubdate">Published on Thursday, October 5th, 2017</span> :: <span><a href="https://homes.cs.washington.edu/~sorawee/th/tags/programming-languages">programming-languages</a>, <a href="https://homes.cs.washington.edu/~sorawee/th/tags/y-combinator">y-combinator</a></span></p>
<p class="update"><span class="pubdate">Updated on Sunday, December 9th, 2018</span></p>
<div class="post-content">
<p>Y combinator ดูเหมือนจะเป็นเวทมนตร์มหัศจรรย์ที่ทำให้เราสามารถเขียน<dfn>ฟังก์ชันเวียนเกิด</dfn> (recursive function) ใน<a href="https://th.wikipedia.org/wiki/แคลคูลัสแลมบ์ดา"><dfn>แคลคูลัสแลมบ์ดา</dfn></a> (lambda calculus) ได้ เนื่องจากความมหัศจรรย์ของมัน หลาย ๆ คนจึงพยายามที่จะอธิบายว่ามันคืออะไรและทำงานได้อย่างไร แต่เรารู้สึกว่าคำอธิบายส่วนใหญ่นั้นน่าผิดหวัง เพราะมักจะกำหนด Y combinator ขึ้นมาตั้งแต่แรกและเพียงแค่แสดงให้เห็นว่ามันทำงานถูกต้อง ซึ่งไม่ได้แสดงให้เห็นว่า<em>เราจะสามารถคิดหา Y combinator ขึ้นมาเองได้อย่างไร</em> คำอธิบายอีกจำพวกพยายามที่จะตอบโจทย์นี้ แต่ก็มักจะมีประโยคเช่น “เราไม่รู้ว่าเราควรจะใส่อะไรเข้าไปเป็นพารามิเตอร์ของฟังก์ชันนี้ ทำไมถึงไม่ลองใส่ตัวเองเข้าไปดูล่ะ! และเห็นไหมว่ามันทำงานได้อย่างที่เราต้องการ!” ซึ่งเรารู้สึกว่ามันควรจะมีวิธีอธิบายที่ไม่ต้องใช้การทดลองมั่วแบบนี้ได้ จึงเป็นที่มาของบทความนี้</p>
<h2 id="บทนำ">บทนำ <a class="self-ref" href="#บทนำ">#</a></h2>
<p>แคลคูลัสแลมบ์ดาไม่มีความสามารถโดยกำเนิดในการนิยามฟังก์ชันเวียนเกิด คำถามที่เราสนใจคือ <i>เป็นไปได้หรือไม่ที่เราจะสามารถหาทางนิยามฟังก์ชันเวียนเกิดแม้ว่าจะมีข้อจำกัดนี้ก็ตาม?</i></p>
<p>ถึงแม้ว่าบทความนี้จะเกี่ยวกับแคลคูลัสแลมบ์ดา แต่เราจะใช้ภาษาโปรแกรมจริง ๆ ในการอธิบายเพื่อให้เข้าใจง่ายขึ้น ในที่นี้ เราจะใช้ภาษา <a href="http://racket-lang.org">Racket</a><label for="margin-note-1" class="margin-note-toggle margin-note-number"></label><input type="checkbox" id="margin-note-1" class="margin-note-toggle"/><object class="margin-note"><div class="margin-note-box" decode="exclude-paragraph">เราเลือกที่จะใช้ภาษา Racket เพราะว่า 
<ul><li>Racket ไม่มี<a href="https://en.wikipedia.org/wiki/Type_system#Static_type_checking"><dfn>การตรวจสอบชนิดข้อมูลล่วงหน้า</dfn></a> (static type checking) ซึ่งส่วนมากแล้วมักจะเคร่งครัดมากเกินไปและตัดสินว่าโปรแกรมที่ใช้ Y combinator มีข้อผิดพลาดทางชนิดข้อมูล</li>
<li>Racket มีกฎเกี่ยวกับขอบเขตตัวแปรที่เรียบง่ายและใกล้เคียงกับแคลคูลัสแลมบ์ดา ไม่เหมือนภาษาเช่น Python และ JavaScript ซึ่งมีกฎเกี่ยวกับ<dfn>การยกตัวแปรขึ้น</dfn> (variable hoisting) ที่ซับซ้อน และทำให้โปรแกรมเช่น <code>const f = () =&gt; f();</code> ที่ดูเหมือนไม่น่าจะมีการเรียกซ้ำ มีการเรียกซ้ำเกิดขึ้น</li>
</ul></div>
</object> แต่ภาษาอื่นก็อาจจะใช้ได้เหมือนกัน</p>
<p>สำหรับบทความนี้ ผู้อ่านควรจะมีความคุ้นเคยกับทฤษฎีภาษาโปรแกรมเบื้องต้น แต่เราจะพยายามลิงก์ไปยังบทความต่าง ๆ เพื่อให้ผู้อ่านที่ไม่มีพื้นฐานสามารถตามได้</p>
<h2 id="enabling-recursion">เพิ่มการเรียกซ้ำ <a class="self-ref" href="#enabling-recursion">#</a></h2>
<p>ใน Racket เราสามารถเขียนโค้ดเพื่อคำนวณหาค่า $3! + 4!$ ได้อย่างง่ายดาย<label for="margin-note-2" class="margin-note-toggle margin-note-number"></label><input type="checkbox" id="margin-note-2" class="margin-note-toggle"/><object class="margin-note"><div class="margin-note-box" decode="exclude-paragraph">ภาษา Racket มีภาษาย่อยอยู่มากมาย ในบทความนี้เราจะใช้ภาษา Racket มาตรฐาน (<code>#lang racket</code>) เป็นหลัก ดังนั้นเราจะไม่เขียน<a href="https://docs.racket-lang.org/guide/more-hash-lang.html">บรรทัดระบุภาษา</a>ดังกล่าวนับจากโค้ดนี้เป็นต้นไป เว้นเสียแต่ตอนที่เราจะใช้ภาษาย่อยอื่น ๆ</div>
</object></p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre>1
2
3
4
5
6
7</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-1"><span></span><span class="kn">#lang </span><span class="nn">racket</span>

<span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._letrec))">letrec</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">n</span><span class="p">)</span></span>
                 <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/case.html#(form._((lib._racket/private/more-scheme..rkt)._case))">case</a></span> <span class="n">n</span>
                   <span class="paren"><span class="p">[</span><span class="paren"><span class="p">(</span><span class="mi">0</span><span class="p">)</span></span> <span class="mi">1</span><span class="p">]</span></span>
                   <span class="paren"><span class="p">[</span><span class="k"><a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket/private/letstx-scheme..rkt)._else))">else</a></span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))">*</a></span> <span class="n">n</span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))">-</a></span> <span class="n">n</span> <span class="mi">1</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
  <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="mi">3</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="mi">4</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-1"><i class="far fa-copy"></i></button></div>
</div>
<div class="highlight-container"><div class="highlight"><pre id="output-id-1">30</pre>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#output-id-1"><i class="far fa-copy"></i></button></div>
</div>
<p>เราสามารถนิยามฟังก์ชันเวียนเกิด <code>fact</code> นี้ได้ เพราะว่า <a href="https://docs.racket-lang.org/guide/let.html#%28part._.Recursive_.Binding__letrec%29"><dfn><code>letrec</code></dfn></a><label for="margin-note-3" class="margin-note-toggle margin-note-number"></label><input type="checkbox" id="margin-note-3" class="margin-note-toggle"/><object class="margin-note"><div class="margin-note-box" decode="exclude-paragraph">อ่าน <code>(letrec ([‹x› ‹v›]) ‹e›)</code> ว่า “ให้ <code>‹x›</code> เป็นฟังก์ชันเวียนเกิด <code>‹v›</code> และคืนค่า <code>‹e›</code>”</div>
</object> อนุญาตให้เราสามารถอ้างถึง <code>fact</code> ข้างในฟังก์ชันแลมบ์ดาซึ่งจะกลายมาเป็น <code>fact</code> เองในอนาคต</p>
<p>แต่ปัญหาคือแคลคูลัสแลมบ์ดาไม่มี <code>letrec</code>! อันที่จริงแล้ว Racket สร้างคำสั่ง <code>letrec</code> โดยใช้<dfn>การเปลี่ยนข้อมูล</dfn> (mutation)<label for="margin-note-4" class="margin-note-toggle margin-note-number"></label><input type="checkbox" id="margin-note-4" class="margin-note-toggle"/><object class="margin-note"><div class="margin-note-box" decode="exclude-paragraph">ตัวอย่างเช่น: <div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre>1
2
3
4
5
6
7</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-2"><span></span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">fact</span> <span class="s2">"dummy-value"</span><span class="p">]</span></span><span class="p">)</span></span>
  <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/begin.html#(form._((quote._~23~25kernel)._begin))">begin</a></span>
    <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/set_.html#(form._((quote._~23~25kernel)._set!))">set!</a></span> <span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">n</span><span class="p">)</span></span>
                 <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/case.html#(form._((lib._racket/private/more-scheme..rkt)._case))">case</a></span> <span class="n">n</span>
                   <span class="paren"><span class="p">[</span><span class="paren"><span class="p">(</span><span class="mi">0</span><span class="p">)</span></span> <span class="mi">1</span><span class="p">]</span></span>
                   <span class="paren"><span class="p">[</span><span class="k"><a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket/private/letstx-scheme..rkt)._else))">else</a></span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))">*</a></span> <span class="n">n</span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))">-</a></span> <span class="n">n</span> <span class="mi">1</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
    <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="mi">3</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="mi">4</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span></pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-2"><i class="far fa-copy"></i></button></div>
</div>
</div>
</object> ซึ่งก็ไม่มีในแคลคูลัสแลมบ์ดาเช่นเดียวกัน ฉะนั้นแล้วเป้าหมายของเราคือการเขียนฟังก์ชัน <code>fact</code> ใน Racket โดยไม่ใช้คำสั่ง <code>letrec</code> และการเปลี่ยนข้อมูล</p>
<p>เราจะลองแก้โค้ดแบบง่าย ๆ ตรงไปตรงมากันก่อน</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre>1
2
3
4
5</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-3"><span></span><span class="paren"><span class="p">(</span><mark class="highlight-add"><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span></mark> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">n</span><span class="p">)</span></span>
              <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/case.html#(form._((lib._racket/private/more-scheme..rkt)._case))">case</a></span> <span class="n">n</span>
                <span class="paren"><span class="p">[</span><span class="paren"><span class="p">(</span><span class="mi">0</span><span class="p">)</span></span> <span class="mi">1</span><span class="p">]</span></span>
                <span class="paren"><span class="p">[</span><span class="k"><a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket/private/letstx-scheme..rkt)._else))">else</a></span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))">*</a></span> <span class="n">n</span> <span class="paren"><span class="p">(</span><mark class="highlight-focus"><span class="n">fact</span></mark> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))">-</a></span> <span class="n">n</span> <span class="mi">1</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
  <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="mi">3</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="mi">4</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-3"><i class="far fa-copy"></i></button></div>
</div>
<div class="highlight-container"><div class="highlight"><pre id="output-id-2"><span class="text-type-error">fact: unbound identifier in: fact</span></pre>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#output-id-2"><i class="far fa-copy"></i></button></div>
</div>
<p>เราเพียงแค่เปลี่ยน <code>letrec</code> ให้กลายเป็น <a href="https://docs.racket-lang.org/guide/let.html#%28part._.Parallel_.Binding__let%29"><dfn><code>let</code></dfn></a><label for="margin-note-5" class="margin-note-toggle margin-note-number"></label><input type="checkbox" id="margin-note-5" class="margin-note-toggle"/><object class="margin-note"><div class="margin-note-box" decode="exclude-paragraph">อ่าน <code>(let ([‹x› ‹v›]) ‹e›)</code> ว่า “ให้ <code>‹x›</code> เป็นค่า <code>‹v›</code> และคืนค่า <code>‹e›</code>”</div>
</object> ในขณะที่ <code>letrec</code> และ <code>let</code> ดูคล้าย ๆ กัน <code>let</code> ไม่มีความสามารถที่จะอนุญาตให้เราอ้างถึง <code>fact</code> ข้างในฟังก์ชันแลมบ์ดาที่จะกลายมาเป็น <code>fact</code> เองในอนาคต อันที่จริงแล้ว <code>(let ([‹x› ‹v›]) ‹e›)</code> ไม่ได้เพิ่ม<dfn>พลัง</dfn> (expressive power) ใด ๆ ให้กับแคลคูลัสแลมบ์ดาทั้งสิ้น เนื่องจากความหมายของมันเทียบเท่าทุกประการกับ <code>((λ (‹x›) ‹e›) ‹v›)</code> ซึ่งเป็นพจน์ในแคลคูลัสแลมบ์ดา บางภาษาโปรแกรมนับให้ <code>let</code> เป็นเพียง <a href="https://en.wikipedia.org/wiki/Syntactic_sugar"><dfn>syntactic sugar</dfn></a> และคอมไพล์ <code>(let ([‹x› ‹v›]) ‹e›)</code> ให้กลายเป็น <code>((λ (‹x›) ‹e›) ‹v›)</code> ก่อนที่จะเริ่มรันโปรแกรม</p>
<p>โค้ดข้างต้นมีข้อผิดพลาดเนื่องจากตัวแปร <code>fact</code> ที่เราไฮไลท์ไว้<dfn>ไม่ได้ถูกนิยามในขอบเขตที่เหมาะสม</dfn> (unbound) เราควรจะแก้ไขข้อผิดพลาดนี้อย่างไรดี? ลองมาดูตัวอย่างอีกอันหนึ่งที่เรียบง่ายมากกว่ากันดู</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre>1
2
3</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-4"><span></span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">f</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">n</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <span class="n">n</span> <mark class="highlight-focus"><span class="n">c</span></mark><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
  <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">c</span> <span class="mi">1</span><span class="p">]</span></span><span class="p">)</span></span>
    <span class="paren"><span class="p">(</span><span class="n">f</span> <span class="mi">99</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-4"><i class="far fa-copy"></i></button></div>
</div>
<div class="highlight-container"><div class="highlight"><pre id="output-id-3"><span class="text-type-error">c: unbound identifier in: c</span></pre>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#output-id-3"><i class="far fa-copy"></i></button></div>
</div>
<p>โค้ดนี้มีปัญหาที่คล้าย ๆ กัน นั่นคือ <code>c</code> ที่เราไฮไลท์ไว้ไม่ได้ถูกนิยามในขอบเขตที่เหมาะสม วิธีการหนึ่งที่จะแก้ไขปัญหานี้คือ ส่งค่าของ <code>c</code> ในจุดที่ <code>c</code> ถูกนิยามอย่างถูกต้องเข้าไปยังฟังก์ชันแลมบ์ดา เพื่อที่ <code>c</code> ที่เราไฮไลท์ไว้จะได้ถูกนิยามในขอบเขตที่เหมาะสม</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre>1
2
3</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-5"><span></span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">f</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><mark class="highlight-add"><span class="n">c</span></mark> <span class="n">n</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <span class="n">n</span> <span class="n">c</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
  <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">c</span> <span class="mi">1</span><span class="p">]</span></span><span class="p">)</span></span>
    <span class="paren"><span class="p">(</span><span class="n">f</span> <mark class="highlight-add"><span class="n">c</span></mark> <span class="mi">99</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-5"><i class="far fa-copy"></i></button></div>
</div>
<div class="highlight-container"><div class="highlight"><pre id="output-id-4">100</pre>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#output-id-4"><i class="far fa-copy"></i></button></div>
</div>
<p>เราจะแก้ไขปัญหาเกี่ยวกับตัวแปร <code>fact</code> ที่ไม่ได้ถูกนิยามในขอบเขตที่เหมาะสมด้วยวิธีเดียวกัน สังเกตว่าตัวแปร <code>fact</code> ถูกนิยามอย่างอย่างถูกต้องข้างใน <code>let</code> ฉะนั้นเราสามารถที่จะส่ง <code>fact</code> เข้าไปข้างในฟังก์ชันแลมบ์ดาได้!</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre>1
2
3
4
5</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-6"><span></span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><mark class="highlight-add"><span class="n">fact</span></mark> <span class="n">n</span><span class="p">)</span></span>
              <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/case.html#(form._((lib._racket/private/more-scheme..rkt)._case))">case</a></span> <span class="n">n</span>
                <span class="paren"><span class="p">[</span><span class="paren"><span class="p">(</span><span class="mi">0</span><span class="p">)</span></span> <span class="mi">1</span><span class="p">]</span></span>
                <span class="paren"><span class="p">[</span><span class="k"><a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket/private/letstx-scheme..rkt)._else))">else</a></span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))">*</a></span> <span class="n">n</span> <mark class="highlight-focus"><span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))">-</a></span> <span class="n">n</span> <span class="mi">1</span><span class="p">)</span></span><span class="p">)</span></span></mark><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
  <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <mark class="highlight-add"><span class="n">fact</span></mark> <span class="mi">3</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <mark class="highlight-add"><span class="n">fact</span></mark> <span class="mi">4</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-6"><i class="far fa-copy"></i></button></div>
</div>
<div class="highlight-container"><div class="highlight"><pre id="output-id-5"><span class="text-type-error">fact: arity mismatch;
the expected number of arguments does not match the given number
 expected: 2
 given: 1
 arguments...:</span></pre>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#output-id-5"><i class="far fa-copy"></i></button></div>
</div>
<p>แต่ปรากฏว่าโค้ดข้างต้นก็ยังมีปัญหาอยู่ดี: <code>fact</code> ตอนนี้เป็นฟังก์ชันที่มี 2 พารามิเตอร์ ฉะนั้นแล้วการเรียกฟังก์ชันที่เราไฮไลท์ไว้ ซึ่งส่งพารามิเตอร์เข้าไปเพียงแค่ตัวเดียว จึงส่งผลให้เกิดข้อผิดพลาด ฟังก์ชั่น <code>fact</code> ต้องการอะไรเป็นพารามิเตอร์แรก? คำตอบคือฟังก์ชัน <code>fact</code>!</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre>1
2
3
4
5</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-7"><span></span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="n">n</span><span class="p">)</span></span>
              <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/case.html#(form._((lib._racket/private/more-scheme..rkt)._case))">case</a></span> <span class="n">n</span>
                <span class="paren"><span class="p">[</span><span class="paren"><span class="p">(</span><span class="mi">0</span><span class="p">)</span></span> <span class="mi">1</span><span class="p">]</span></span>
                <span class="paren"><span class="p">[</span><span class="k"><a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket/private/letstx-scheme..rkt)._else))">else</a></span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))">*</a></span> <span class="n">n</span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <mark class="highlight-add"><span class="n">fact</span></mark> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))">-</a></span> <span class="n">n</span> <span class="mi">1</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
  <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="n">fact</span> <span class="mi">3</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="n">fact</span> <span class="mi">4</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-7"><i class="far fa-copy"></i></button></div>
</div>
<div class="highlight-container"><div class="highlight"><pre id="output-id-6">30</pre>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#output-id-6"><i class="far fa-copy"></i></button></div>
</div>
<p>ด้วยทริคข้างบนนี้ ดูเหมือนว่าเราจะสามารถเขียนฟังก์ชันเวียนเกิดใด ๆ ในภาษาที่ไม่มี <code>letrec</code> ได้ด้วย<dfn>วิธีการ ก.</dfn> ดังต่อไปนี้</p>
<figure class="figure">
<ol>
<li>เริ่มต้นด้วยการเขียนฟังก์ชันเวียนเกิด $f$ โดยใช้ <code>letrec</code></li>
<li>เปลี่ยน <code>letrec</code> ไปเป็น <code>let</code></li>
<li>ในทุก ๆ จุดที่เราเรียก $f$ ให้เพิ่ม $f$ เข้าไปเป็นพารามิเตอร์แรก</li>
<li>ในฟังก์ชันแลมบ์ดา $f$ ให้รับ $f$ เพิ่มเข้ามาเป็นพารามิเตอร์แรก</li>
</ol><figcaption class="figure-caption text-center">วิธีการ ก.</figcaption>
</figure>
<p>แต่วิธีการ ก. ถูกต้องเสมอไปหรือเปล่า? ลองพิจารณาโค้ดต่อไปนี้ดู</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre>1
2
3
4
5
6</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-8"><span></span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._letrec))">letrec</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">n</span><span class="p">)</span></span>
                 <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/case.html#(form._((lib._racket/private/more-scheme..rkt)._case))">case</a></span> <span class="n">n</span>
                   <span class="paren"><span class="p">[</span><span class="paren"><span class="p">(</span><span class="mi">0</span><span class="p">)</span></span> <span class="mi">1</span><span class="p">]</span></span>
                   <span class="paren"><span class="p">[</span><span class="k"><a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket/private/letstx-scheme..rkt)._else))">else</a></span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))">*</a></span> <span class="n">n</span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))">-</a></span> <span class="n">n</span> <span class="mi">1</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
  <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">fact2</span> <span class="n">fact</span><span class="p">]</span></span><span class="p">)</span></span>
    <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <span class="paren"><span class="p">(</span><span class="n">fact2</span> <span class="mi">3</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact2</span> <span class="mi">4</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-8"><i class="far fa-copy"></i></button></div>
</div>
<div class="highlight-container"><div class="highlight"><pre id="output-id-7">30</pre>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#output-id-7"><i class="far fa-copy"></i></button></div>
</div>
<p>แปลงกลายเป็น</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre>1
2
3
4
5
6</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-9"><span></span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="n">n</span><span class="p">)</span></span>
              <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/case.html#(form._((lib._racket/private/more-scheme..rkt)._case))">case</a></span> <span class="n">n</span>
                <span class="paren"><span class="p">[</span><span class="paren"><span class="p">(</span><span class="mi">0</span><span class="p">)</span></span> <span class="mi">1</span><span class="p">]</span></span>
                <span class="paren"><span class="p">[</span><span class="k"><a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket/private/letstx-scheme..rkt)._else))">else</a></span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))">*</a></span> <span class="n">n</span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))">-</a></span> <span class="n">n</span> <span class="mi">1</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
  <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">fact2</span> <span class="n">fact</span><span class="p">]</span></span><span class="p">)</span></span>
    <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <span class="paren"><span class="p">(</span><span class="n">fact2</span> <span class="mi">3</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact2</span> <span class="mi">4</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-9"><i class="far fa-copy"></i></button></div>
</div>
<div class="highlight-container"><div class="highlight"><pre id="output-id-8"><span class="text-type-error">fact: arity mismatch;
 the expected number of arguments does not match the given number
  expected: 2
  given: 1
  arguments...:</span></pre>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#output-id-8"><i class="far fa-copy"></i></button></div>
</div>
<p>อย่างที่เราได้เห็น วิธีการ ก. นี้ไม่ถูกต้องเสมอไปซะทีเดียว เพราะถ้า $f$ อยู่ในตำแหน่งที่ไม่ใช่ฟังก์ชัน จะไม่มีการเปลี่ยนแปลงโค้ดที่เหมาะสมเกิดขึ้น แต่โชคยังดีเพราะเราสามารถบังคับให้ทุก ๆ $f$ ที่ปรากฏในโปรแกรมอยู่ในตำแหน่งฟังก์ชันเสมอ! ถ้า $f$ เป็นฟังก์ชันที่รับ $n$ พารามิเตอร์ จะได้ว่า $f$ <a href="https://en.wikipedia.org/wiki/Observational_equivalence"><dfn>มีความหมายเทียบเท่า</dfn></a> (observationally equivalent) กับ $\lam{x_1 x_2 \dots x_n}{f x_1 x_2 \dots x_n}$ (เมื่อ $f$ ไม่ได้เป็นหนึ่งใน $x_1, x_2, \dots, x_n$)<label for="margin-note-6" class="margin-note-toggle margin-note-number"></label><input type="checkbox" id="margin-note-6" class="margin-note-toggle"/><object class="margin-note"><div class="margin-note-box" decode="exclude-paragraph">ความเท่าเทียมกันระหว่าง $f$ กับ $\lam{x_1 x_2 \dots x_n}{f x_1 x_2 \dots x_n}$ เป็นกรณีพิเศษของ <a href="https://en.wikipedia.org/wiki/Lambda_calculus#%CE%B7-conversion"><dfn>$\eta$-equivalence</dfn></a> โดยในแคลคูลัสแลมบ์ดา เราสามารถใช้ $\eta$-conversion ที่ไหนก็ได้ เพราะทุก ๆ พจน์มีความหมายเป็นฟังก์ชันแลมบ์ดาหนึ่ง ๆ เสมอ แต่เนื่องจาก Racket มีข้อมูลประเภทอื่นเช่นตัวเลข เราจึงสามารถใช้ $\eta$-conversion ได้อย่างจำกัดเท่านั้น</div>
</object> ดังนั้น หากเราแทรกขั้นตอนเพิ่มระหว่างขั้นที่ 2 กับขั้นที่ 3 ของวิธีการ ก. เพื่อเปลี่ยนทุก ๆ ตัวแปร $f$ ให้กลายเป็น $\lam{x_1 x_2 \dots x_n}{f x_1 x_2 \dots x_n}$ เราจะได้<dfn>วิธีการ ข.</dfn> ซึ่งทำงานถูกต้องกับทุก ๆ โปรแกรม</p>
<figure class="figure">
<ol>
<li>เริ่มต้นด้วยการเขียนฟังก์ชันเวียนเกิด $f$ โดยใช้ <code>letrec</code></li>
<li>เปลี่ยน <code>letrec</code> ไปเป็น <code>let</code></li>
<li><ins>เปลี่ยนทุก ๆ ตัวแปร $f$ ให้กลายเป็น $\lam{x_1 x_2 \dots x_n}{f x_1 x_2 \dots x_n}$</ins></li>
<li>ในทุก ๆ จุดที่เราเรียก $f$ ให้เพิ่ม $f$ เข้าไปเป็นพารามิเตอร์แรก</li>
<li>ในฟังก์ชันแลมบ์ดา $f$ ให้รับ $f$ เพิ่มเข้ามาเป็นพารามิเตอร์แรก</li>
</ol><figcaption class="figure-caption text-center">วิธีการ ข.</figcaption>
</figure>
<p>ลองมาใช้วิธีการ ข. ดูกัน!</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre>1
2
3
4
5
6</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-10"><span></span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._letrec))">letrec</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">n</span><span class="p">)</span></span>
                 <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/case.html#(form._((lib._racket/private/more-scheme..rkt)._case))">case</a></span> <span class="n">n</span>
                   <span class="paren"><span class="p">[</span><span class="paren"><span class="p">(</span><span class="mi">0</span><span class="p">)</span></span> <span class="mi">1</span><span class="p">]</span></span>
                   <span class="paren"><span class="p">[</span><span class="k"><a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket/private/letstx-scheme..rkt)._else))">else</a></span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))">*</a></span> <span class="n">n</span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))">-</a></span> <span class="n">n</span> <span class="mi">1</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
  <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">fact2</span> <span class="n">fact</span><span class="p">]</span></span><span class="p">)</span></span>
    <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <span class="paren"><span class="p">(</span><span class="n">fact2</span> <span class="mi">3</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact2</span> <span class="mi">4</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-10"><i class="far fa-copy"></i></button></div>
</div>
<p>แปลงกลายเป็น</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre>1
2
3
4
5
6</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-11"><span></span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="n">n</span><span class="p">)</span></span>
              <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/case.html#(form._((lib._racket/private/more-scheme..rkt)._case))">case</a></span> <span class="n">n</span>
                <span class="paren"><span class="p">[</span><span class="paren"><span class="p">(</span><span class="mi">0</span><span class="p">)</span></span> <span class="mi">1</span><span class="p">]</span></span>
                <span class="paren"><span class="p">[</span><span class="k"><a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket/private/letstx-scheme..rkt)._else))">else</a></span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))">*</a></span> <span class="n">n</span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">v</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="n">fact</span> <span class="n">v</span><span class="p">)</span></span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))">-</a></span> <span class="n">n</span> <span class="mi">1</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
  <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">fact2</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">v</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="n">fact</span> <span class="n">v</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
    <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <span class="paren"><span class="p">(</span><span class="n">fact2</span> <span class="mi">3</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact2</span> <span class="mi">4</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-11"><i class="far fa-copy"></i></button></div>
</div>
<div class="highlight-container"><div class="highlight"><pre id="output-id-9">30</pre>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#output-id-9"><i class="far fa-copy"></i></button></div>
</div>
<p>เยี่ยม!</p>
<h2 id="โอเมกา">โอเมกา <a class="self-ref" href="#โอเมกา">#</a></h2>
<p>เราจะออกทะเลกันเล็กน้อย จะเกิดอะไรขึ้นถ้าเราใช้การเปลี่ยนแปลงโปรแกรมที่ได้กล่าวไว้ข้างต้นกับฟังก์ชันที่เรียกตัวเองไปเรื่อย ๆ เป็นวงวนไม่รู้จบ?</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre>1
2</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-12"><span></span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._letrec))">letrec</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">diverge</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">diverge</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
  <span class="paren"><span class="p">(</span><span class="n">diverge</span><span class="p">)</span></span><span class="p">)</span></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-12"><i class="far fa-copy"></i></button></div>
</div>
<p>เนื่องจากตัวแปร <code>diverge</code> ทุก ๆ ตัวอยู่ในตำแหน่งฟังก์ชัน เราเลยสามารถใช้วิธีการ ก. ได้ ซึ่งเปลี่ยนโค้ดข้างต้นเป็น</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre>1
2</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-13"><span></span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">diverge</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">diverge</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">diverge</span> <span class="n">diverge</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
  <span class="paren"><span class="p">(</span><span class="n">diverge</span> <span class="n">diverge</span><span class="p">)</span></span><span class="p">)</span></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-13"><i class="far fa-copy"></i></button></div>
</div>
<p>แคลคูลัสแลมบ์ดาไม่มี <code>let</code> แต่เราสามารถเปลี่ยน <code>let</code> ไปเป็นพจน์ในแคลคูลัสแลมบ์ดาตามที่ได้เคยกล่าวไว้</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre>1
2</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-14"><span></span><span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">diverge</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">diverge</span> <span class="n">diverge</span><span class="p">)</span></span><span class="p">)</span></span>
 <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">diverge</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">diverge</span> <span class="n">diverge</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-14"><i class="far fa-copy"></i></button></div>
</div>
<p>พจน์ข้างบนนี้รู้จักกันในชื่อ $\Omega$-combinator ซึ่งเป็นตัวอย่างมาตรฐานในตำราเรียนว่าเป็นพจน์ในแคลคูลัสแลมบ์ดาที่เมื่อรันแล้ว ในแต่ละขั้นจะได้ตัวเองไปเรื่อย ๆ ไม่ได้มีผลลัพธ์ออกมาเป็นค่าข้อมูล</p>
<h2 id="deriving-family">ตามล่าหาครอบครัวของ Y combinator <a class="self-ref" href="#deriving-family">#</a></h2>
<p>ในขณะที่เรารู้วิธีในการเขียนฟังก์ชันเวียนเกิดในแคลคูลัสแลมบ์ดาแล้ว โปรแกรมที่เราเขียนมีรูปร่างไม่คล้ายคลึงกับโปรแกรมดั้งเดิมที่ใช้ <code>letrec</code> มันคงจะดีไม่น้อยถ้าหากมีพจน์ <code>‹make-recursion›</code> ซึ่งทำให้</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre>1
2
3
4
5</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-15"><span></span><span class="paren"><span class="p">(</span><span class="n">‹make-recursion›</span>
  <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">n</span><span class="p">)</span></span>
    <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/case.html#(form._((lib._racket/private/more-scheme..rkt)._case))">case</a></span> <span class="n">n</span>
      <span class="paren"><span class="p">[</span><span class="paren"><span class="p">(</span><span class="mi">0</span><span class="p">)</span></span> <span class="mi">1</span><span class="p">]</span></span>
      <span class="paren"><span class="p">[</span><span class="k"><a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket/private/letstx-scheme..rkt)._else))">else</a></span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))">*</a></span> <span class="n">n</span> <span class="paren"><span class="p">(</span><mark class="highlight-focus"><span class="n">fact</span></mark> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))">-</a></span> <span class="n">n</span> <span class="mi">1</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-15"><i class="far fa-copy"></i></button></div>
</div>
<p>กลายเป็นฟังก์ชันแฟกทอเรียล แต่โค้ดข้างต้นมีปัญหาที่เห็นได้ชัด นั่นคือ ตัวแปร <code>fact</code> ไม่ได้ถูกนิยามในขอบเขตที่เหมาะสม เราจะแก้ปัญหานี้ด้วยการคลุมโค้ดข้างในด้วยฟังก์ชันแลมบ์ดา เพื่อทำให้ <code>fact</code> ถูกนิยามในขอบเขตที่เหมาะสม</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre>1
2
3
4
5
6</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-16"><span></span><span class="paren"><span class="p">(</span><span class="n">‹make-recursion›</span>
  <span class="paren"><span class="p">(</span><mark class="highlight-add"><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span></mark>
    <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">n</span><span class="p">)</span></span>
      <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/case.html#(form._((lib._racket/private/more-scheme..rkt)._case))">case</a></span> <span class="n">n</span>
        <span class="paren"><span class="p">[</span><span class="paren"><span class="p">(</span><span class="mi">0</span><span class="p">)</span></span> <span class="mi">1</span><span class="p">]</span></span>
        <span class="paren"><span class="p">[</span><span class="k"><a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket/private/letstx-scheme..rkt)._else))">else</a></span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))">*</a></span> <span class="n">n</span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))">-</a></span> <span class="n">n</span> <span class="mi">1</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-16"><i class="far fa-copy"></i></button></div>
</div>
<p>เราจะเรียกฟังก์ชันแลมบ์ดาซึ่งเป็นพารามิเตอร์ของ <code>‹make-recursion›</code> ว่า<dfn>ตัวสร้างฟังก์ชันเวียนเกิด</dfn> และสิ่งที่เราอยากได้คือ สำหรับตัวสร้างฟังก์ชันเวียนเกิด <code>‹recursion-maker›</code> ใด ๆ <code>(‹make-recursion› ‹recursion-maker›)</code> ควรจะกลายมาเป็นฟังก์ชันเวียนเกิดที่เราสามารถใช้งานได้ตามปกติ</p>
<p>เราควรจะเริ่มต้นอย่างไรดี? ถึงแม้ว่าเราจะไม่รู้ว่า <code>‹make-recursion›</code> มีรูปร่างเป็นอย่างไร แต่เรารู้ว่า <code>‹fact-maker›</code> มีรูปร่างเป็นอย่างไร ฉะนั้น เราจะพยายามจัดรูปโค้ดที่มีการใช้วิธีการ ข. เพื่อเขียนฟังก์ชันแฟกทอเรียล:</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre>1
2
3
4
5</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-17"><span></span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="n">n</span><span class="p">)</span></span>
              <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/case.html#(form._((lib._racket/private/more-scheme..rkt)._case))">case</a></span> <span class="n">n</span>
                <span class="paren"><span class="p">[</span><span class="paren"><span class="p">(</span><span class="mi">0</span><span class="p">)</span></span> <span class="mi">1</span><span class="p">]</span></span>
                <span class="paren"><span class="p">[</span><span class="k"><a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket/private/letstx-scheme..rkt)._else))">else</a></span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))">*</a></span> <span class="n">n</span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">v</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="n">fact</span> <span class="n">v</span><span class="p">)</span></span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))">-</a></span> <span class="n">n</span> <span class="mi">1</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
  <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">v</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="n">fact</span> <span class="n">v</span><span class="p">)</span></span><span class="p">)</span></span> <span class="mi">3</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">v</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="n">fact</span> <span class="n">v</span><span class="p">)</span></span><span class="p">)</span></span> <span class="mi">4</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-17"><i class="far fa-copy"></i></button></div>
</div>
<p>ให้กลายเป็นโค้ดที่มีการใช้ <code>‹fact-maker›</code>:</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre>1
2
3
4
5
6
7</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-18"><span></span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">fact-maker</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span>
                    <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">n</span><span class="p">)</span></span>
                      <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/case.html#(form._((lib._racket/private/more-scheme..rkt)._case))">case</a></span> <span class="n">n</span>
                        <span class="paren"><span class="p">[</span><span class="paren"><span class="p">(</span><span class="mi">0</span><span class="p">)</span></span> <span class="mi">1</span><span class="p">]</span></span>
                        <span class="paren"><span class="p">[</span><span class="k"><a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket/private/letstx-scheme..rkt)._else))">else</a></span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))">*</a></span> <span class="n">n</span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))">-</a></span> <span class="n">n</span> <span class="mi">1</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
  <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="n">‹???›</span> <span class="n">fact-maker</span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
    <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="mi">3</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="mi">4</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-18"><i class="far fa-copy"></i></button></div>
</div>
<p>ถ้าหากเราสามารถแปลงโค้ดได้สำเร็จ ก็จะได้ว่าช่องว่าง <code>‹???›</code> คือ <code>‹make-recursion›</code> ที่เรากำลังตามหา</p>
<p>สำหรับขั้นตอนแรก สังเกตว่าทั้ง <code>fact</code> และ <code>n</code> เป็นพารามิเตอร์ของฟังก์ชันแลมบ์ดาในโค้ดที่เรามี แต่ใน <code>‹fact-maker›</code> มีฟังก์ชันแลมบ์ดาสองอันแยกกัน ฉะนั้นแล้ว เราสามารถใช้ <a href="https://en.wikipedia.org/wiki/Currying"><dfn>currying</dfn></a> ในการแยกพารามิเตอร์ออกจากกันได้ แน่นอนว่าเราต้องเปลี่ยนการเรียกฟังก์ชันตามให้ถูกต้องด้วยเช่นกัน นั่นคือเราจะเปลี่ยน</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre>1
2
3
4
5</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-19"><span></span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="n">n</span><span class="p">)</span></span>
              <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/case.html#(form._((lib._racket/private/more-scheme..rkt)._case))">case</a></span> <span class="n">n</span>
                <span class="paren"><span class="p">[</span><span class="paren"><span class="p">(</span><span class="mi">0</span><span class="p">)</span></span> <span class="mi">1</span><span class="p">]</span></span>
                <span class="paren"><span class="p">[</span><span class="k"><a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket/private/letstx-scheme..rkt)._else))">else</a></span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))">*</a></span> <span class="n">n</span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">v</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="n">fact</span> <span class="n">v</span><span class="p">)</span></span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))">-</a></span> <span class="n">n</span> <span class="mi">1</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
  <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">v</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="n">fact</span> <span class="n">v</span><span class="p">)</span></span><span class="p">)</span></span> <span class="mi">3</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">v</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="n">fact</span> <span class="n">v</span><span class="p">)</span></span><span class="p">)</span></span> <span class="mi">4</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-19"><i class="far fa-copy"></i></button></div>
</div>
<p>ไปเป็น</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre>1
2
3
4
5
6</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-20"><span></span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span>
              <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">n</span><span class="p">)</span></span>
                <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/case.html#(form._((lib._racket/private/more-scheme..rkt)._case))">case</a></span> <span class="n">n</span>
                  <span class="paren"><span class="p">[</span><span class="paren"><span class="p">(</span><span class="mi">0</span><span class="p">)</span></span> <span class="mi">1</span><span class="p">]</span></span>
                  <span class="paren"><span class="p">[</span><span class="k"><a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket/private/letstx-scheme..rkt)._else))">else</a></span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))">*</a></span> <span class="n">n</span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">v</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="n">fact</span><span class="p">)</span></span> <span class="n">v</span><span class="p">)</span></span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))">-</a></span> <span class="n">n</span> <span class="mi">1</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
  <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">v</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="n">fact</span><span class="p">)</span></span> <span class="n">v</span><span class="p">)</span></span><span class="p">)</span></span> <span class="mi">3</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">v</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="n">fact</span><span class="p">)</span></span> <span class="n">v</span><span class="p">)</span></span><span class="p">)</span></span> <span class="mi">4</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-20"><i class="far fa-copy"></i></button></div>
</div>
<p>สำหรับขั้นตอนถัดไป สังเกตว่าในโค้ดปัจจุบันของเรา มี <code>(λ (v) ((fact fact) v))</code> ปรากฏไปทั่วในตำแหน่งที่จริง ๆ แล้วเราควรจะสามารถใช้ <code>fact</code> ได้ ดังนั้น เราจะ<dfn>บัง</dfn> (shadow) <code>fact</code> ด้วย <code>(λ (v) ((fact fact) v))</code> เพื่อจัดรูปให้โค้ดปัจจุบันของเราเหมือน <code>‹fact-maker›</code> มากขึ้นไปอีก</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre>1
2
3
4
5
6
7
8</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-21"><span></span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span>
              <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">v</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="n">fact</span><span class="p">)</span></span> <span class="n">v</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
                <mark class="highlight-focus"><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">n</span><span class="p">)</span></span>
                  <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/case.html#(form._((lib._racket/private/more-scheme..rkt)._case))">case</a></span> <span class="n">n</span>
                    <span class="paren"><span class="p">[</span><span class="paren"><span class="p">(</span><span class="mi">0</span><span class="p">)</span></span> <span class="mi">1</span><span class="p">]</span></span>
                    <span class="paren"><span class="p">[</span><span class="k"><a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket/private/letstx-scheme..rkt)._else))">else</a></span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))">*</a></span> <span class="n">n</span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))">-</a></span> <span class="n">n</span> <span class="mi">1</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span><span class="p">)</span></span></mark><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
  <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">v</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="n">fact</span><span class="p">)</span></span> <span class="n">v</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
    <mark class="highlight-focus"><span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="mi">3</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="mi">4</span><span class="p">)</span></span><span class="p">)</span></span></mark><span class="p">)</span></span><span class="p">)</span></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-21"><i class="far fa-copy"></i></button></div>
</div>
<p>ในโค้ดข้างบน ไฮไลท์อันแรกดูคล้ายกับ <code>‹fact-maker›</code> เป็นอย่างมาก และไฮไลท์อันที่สองก็ดูเหมือนโค้ดที่เราควรจะเขียนเพื่อคำนวณ $3! + 4!$ ทุกประการ สิ่งที่เราควรจะทำเป็นลำดับถัดไปคือเปลี่ยน <code>(let ([fact (λ (v) ((fact fact) v))]) ‹body›)</code> ให้กลายมาเป็น <code>(λ (fact) ‹body›)</code> (โดย <code>‹body›</code> คือไฮไลท์อันแรก) แล้วก็ย้าย <code>(λ (v) ((fact fact) v))</code> ออกไปที่อื่น ซึ่งเราสามารถทำได้อย่างง่ายดายด้วยการคอมไพล์ <code>let</code> ให้กลายเป็นพจน์ในแคลคูลัสแลมบ์ดา</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre>1
2
3
4
5
6
7
8
9</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-22"><span></span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span>
              <span class="paren"><span class="p">(</span><mark class="highlight-focus"><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span>
                 <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">n</span><span class="p">)</span></span>
                   <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/case.html#(form._((lib._racket/private/more-scheme..rkt)._case))">case</a></span> <span class="n">n</span>
                     <span class="paren"><span class="p">[</span><span class="paren"><span class="p">(</span><span class="mi">0</span><span class="p">)</span></span> <span class="mi">1</span><span class="p">]</span></span>
                     <span class="paren"><span class="p">[</span><span class="k"><a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket/private/letstx-scheme..rkt)._else))">else</a></span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))">*</a></span> <span class="n">n</span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))">-</a></span> <span class="n">n</span> <span class="mi">1</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span></mark>
               <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">v</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="n">fact</span><span class="p">)</span></span> <span class="n">v</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
  <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">v</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="n">fact</span><span class="p">)</span></span> <span class="n">v</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
    <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="mi">3</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="mi">4</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-22"><i class="far fa-copy"></i></button></div>
</div>
<p>เราทำให้ <code>‹fact-maker›</code> ปรากฏตัวออกมาสำเร็จ! อันดับถัดไป เราสามารถที่จะดึง <code>‹fact-maker›</code> ออกมาเป็นตัวแปรชื่อ <code>fact-maker</code> ได้</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre>1
2
3
4
5
6
7
8</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-23"><span></span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">fact-maker</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span>
                    <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">n</span><span class="p">)</span></span>
                      <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/case.html#(form._((lib._racket/private/more-scheme..rkt)._case))">case</a></span> <span class="n">n</span>
                        <span class="paren"><span class="p">[</span><span class="paren"><span class="p">(</span><span class="mi">0</span><span class="p">)</span></span> <span class="mi">1</span><span class="p">]</span></span>
                        <span class="paren"><span class="p">[</span><span class="k"><a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket/private/letstx-scheme..rkt)._else))">else</a></span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))">*</a></span> <span class="n">n</span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))">-</a></span> <span class="n">n</span> <span class="mi">1</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
  <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact-maker</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">v</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="n">fact</span><span class="p">)</span></span> <span class="n">v</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
    <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">v</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="n">fact</span><span class="p">)</span></span> <span class="n">v</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
      <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="mi">3</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="mi">4</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-23"><i class="far fa-copy"></i></button></div>
</div>
<p>เนื่องจากสุดท้ายแล้ว เราอยากให้ <code>‹make-recursion›</code> เป็นพจน์ในแคลคูลัสแลมบ์ดา แต่ แคลคูลัสแลมบ์ดา ไม่มี <code>let</code> เราจึงจะพยายามรวม <code>(let ([fact ...]) ...)</code> ที่ซ้อนกันสองอันเข้าด้วยกันด้วยการแทนที่แบบตรงไปตรงมา</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre>1
2
3
4
5
6
7
8
9</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-24"><span></span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">fact-maker</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span>
                    <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">n</span><span class="p">)</span></span>
                      <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/case.html#(form._((lib._racket/private/more-scheme..rkt)._case))">case</a></span> <span class="n">n</span>
                        <span class="paren"><span class="p">[</span><span class="paren"><span class="p">(</span><span class="mi">0</span><span class="p">)</span></span> <span class="mi">1</span><span class="p">]</span></span>
                        <span class="paren"><span class="p">[</span><span class="k"><a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket/private/letstx-scheme..rkt)._else))">else</a></span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))">*</a></span> <span class="n">n</span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))">-</a></span> <span class="n">n</span> <span class="mi">1</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
  <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">v</span><span class="p">)</span></span>
                <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact-maker</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">v</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="n">fact</span><span class="p">)</span></span> <span class="n">v</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
                  <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact-maker</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">v</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="n">fact</span><span class="p">)</span></span> <span class="n">v</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span> <span class="n">v</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
    <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="mi">3</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="mi">4</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-24"><i class="far fa-copy"></i></button></div>
</div>
<p>สำหรับขั้นตอนสุดท้าย สังเกตว่า <code>‹make-recursion›</code> ควรจะเป็นฟังก์ชันที่รับ <code>fact-maker</code> เป็นพารามิเตอร์ ฉะนั้น เราจะดึงตัวแปร <code>fact-maker</code> ออกมา</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-25"><span></span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">fact-maker</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span>
                    <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">n</span><span class="p">)</span></span>
                      <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/case.html#(form._((lib._racket/private/more-scheme..rkt)._case))">case</a></span> <span class="n">n</span>
                        <span class="paren"><span class="p">[</span><span class="paren"><span class="p">(</span><span class="mi">0</span><span class="p">)</span></span> <span class="mi">1</span><span class="p">]</span></span>
                        <span class="paren"><span class="p">[</span><span class="k"><a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket/private/letstx-scheme..rkt)._else))">else</a></span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))">*</a></span> <span class="n">n</span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))">-</a></span> <span class="n">n</span> <span class="mi">1</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
  <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><mark class="highlight-focus"><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact-maker</span><span class="p">)</span></span>
                 <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">v</span><span class="p">)</span></span>
                   <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact-maker</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">v</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="n">fact</span><span class="p">)</span></span> <span class="n">v</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
                     <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact-maker</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">v</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="n">fact</span><span class="p">)</span></span> <span class="n">v</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span> <span class="n">v</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span></mark>
               <span class="n">fact-maker</span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
    <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="mi">3</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="mi">4</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-25"><i class="far fa-copy"></i></button></div>
</div>
<div class="highlight-container"><div class="highlight"><pre id="output-id-10">30</pre>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#output-id-10"><i class="far fa-copy"></i></button></div>
</div>
<p>ในที่สุดเราก็ทำสำเร็จ! เราค้นพบว่า <code>‹make-recursion›</code> คือโค้ดที่เราไฮไลท์ไว้</p>
<p>ขั้นตอนที่เราปฏิบัติเพื่อหา <code>‹make-recursion›</code> จริง ๆ แล้วไม่ได้เฉพาะเจาะจงกับฟังก์ชันแฟกทอเรียลเลย ต่อให้เราใช้ฟังก์ชันเวียนเกิดใด ๆ เป็นจุดเริ่มต้น เราก็จะได้พจน์ที่ <a href="https://en.wikipedia.org/wiki/Lambda_calculus#Alpha_equivalence"><dfn>$\alpha$-equivalent</dfn></a> กับ <code>‹make-recursion›</code> ที่เรามี ฉะนั้นแล้ว เพื่อที่จะเน้นว่า <code>‹make-recursion›</code> ไม่ได้เฉพาะเจาะจงกับฟังก์ชันแฟกทอเรียล เราจะเปลี่ยนชื่อตัวแปร ($\alpha$-convert) เพื่อลบการอ้างอิงถึงฟังก์ชันแฟกทอเรียล</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre>1
2
3
4</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-26"><span></span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">f</span><span class="p">)</span></span>
  <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">k</span><span class="p">)</span></span>
    <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">f</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">v</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span> <span class="n">v</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
      <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">f</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">v</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span> <span class="n">v</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span> <span class="n">k</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-26"><i class="far fa-copy"></i></button></div>
</div>
<p>อันที่จริงแล้ว เราสามารถย่อรูป <code>‹make-recursion›</code> ให้เล็กลงได้ด้วย โดยใช้หลักการเดียวกันที่เราเคยใช้ใน<a class="xref" href="#enabling-recursion">เพิ่มการเรียกซ้ำ</a> ว่าถ้าเรารันนิพจน์ $e$ แล้วได้ค่าออกมาเป็นฟังก์ชันที่รับพารามิเตอร์หนึ่งตัว จะได้ว่า $e$ มีความหมายเทียบเท่ากับ $\lam{x}{e x}$ (โดยที่ $e$ ห้ามมีตัวแปร $x$ ที่ไม่ได้ถูกนิยามในขอบเขตที่เหมาะสม) การเปลี่ยนรูปไปมาระหว่าง $e$ กับ $\lam{x}{e x}$ นั้นเป็นที่รู้จักกันในชื่อ <a href="https://en.wikipedia.org/wiki/Lambda_calculus#%CE%B7-conversion"><dfn>$\eta$-conversion</dfn></a> และเราสามารถใช้ $\eta$-conversion ในการสร้างพจน์ต่อไปนี้จาก <code>‹make-recursion›</code> ได้</p>
<ul><li>
<p>เริ่มจาก <code>‹make-recursion›</code> หากเราใช้ $\eta$-conversion กับพจน์ที่เราไฮไลท์</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre>1
2
3
4</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-27"><span></span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">f</span><span class="p">)</span></span>
  <mark class="highlight-focus"><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">k</span><span class="p">)</span></span>
    <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">f</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">v</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span> <span class="n">v</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
      <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">f</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">v</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span> <span class="n">v</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span> <span class="n">k</span><span class="p">)</span></span><span class="p">)</span></span></mark><span class="p">)</span></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-27"><i class="far fa-copy"></i></button></div>
</div>
<p>เราจะได้</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre>1
2
3</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-28"><span></span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">f</span><span class="p">)</span></span>
  <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">f</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">v</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span> <span class="n">v</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
   <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">f</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">v</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span> <span class="n">v</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-28"><i class="far fa-copy"></i></button></div>
</div>
<p>เป็นผลลัพธ์ ซึ่งเป็นที่รู้จักกันในชื่อ <dfn>Z combinator</dfn> ($Z$)</p>
</li>
<li>
<p>เริ่มจาก $Z$ หากเราใช้ $\eta$-conversion กับพจน์ที่เราไฮไลท์</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre>1
2
3</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-29"><span></span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">f</span><span class="p">)</span></span>
  <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">f</span> <mark class="highlight-focus"><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">v</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span> <span class="n">v</span><span class="p">)</span></span><span class="p">)</span></span></mark><span class="p">)</span></span><span class="p">)</span></span>
   <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">f</span> <mark class="highlight-focus"><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">v</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span> <span class="n">v</span><span class="p">)</span></span><span class="p">)</span></span></mark><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-29"><i class="far fa-copy"></i></button></div>
</div>
<p>เราจะได้</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre>1
2
3</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-30"><span></span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">f</span><span class="p">)</span></span>
  <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">f</span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
   <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">f</span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-30"><i class="far fa-copy"></i></button></div>
</div>
<p>เป็นผลลัพธ์ ซึ่งเป็นที่รู้จักกันในชื่อ <dfn>Y combinator</dfn> ($Y$)</p>
</li>
</ul>
<p><code>‹make-recursion›</code>, $Z$ และ $Y$ เป็น <a href="https://en.wikipedia.org/wiki/Fixed-point_combinator"><dfn>fixed-point combinator</dfn></a> โดยคำว่า <a href="https://wiki.haskell.org/Combinator"><dfn>combinator</dfn></a> หมายความว่าพจน์ในแคลคูลัสแลมบ์ดาเหล่านี้ ไม่มีตัวแปรที่ไม่ได้ถูกนิยามในขอบเขตที่เหมาะสม ส่วนคำว่า<a href="https://en.wikipedia.org/wiki/Fixed_point_(mathematics)"><dfn>จุดตรึง</dfn></a> (fixed-point) หมายความว่าผลการเรียกฟังก์ชันของ fixed-point combinator บน $f$ นั้น เป็นคำตอบของสมการ $x = f(x)$ ถ้าเราใช้ $Z$ เป็นตัวอย่าง จะได้ว่า $Z(f) = f(Z(f))$ อัตลักษณ์จุดตรึงนี้มีความสำคัญอย่างไร? และ <code>‹make-recursion›</code>, $Z$ กับ $Y$ แตกต่างกันอย่างไร? เราจะตอบคำถามเหล่านี้ในส่วนถัดไปของบทความนี้</p>
<h2 id="จุดตรึง">จุดตรึง <a class="self-ref" href="#จุดตรึง">#</a></h2>
<p>ทำไมเอกลักษณ์จุดตรึง เช่น $Z(f) = f(Z(f))$ ถึงเป็นจริง และเอกลักษณ์นี้มีความสำคัญอย่างไร? เราจะตอบคำถามเหล่านี้ในส่วนนี้ของบทความ โดยเราจะใช้ Z combinator เป็นตัวอย่างหลัก</p>
<p>อันดับแรก เราจะพิจารณาตัวสร้างฟังก์ชันเวียนเกิดจากมุมมองใหม่ ใน<a class="xref" href="#deriving-family">ตามล่าหาครอบครัวของ Y combinator</a> เราได้เห็นตัวสร้างฟังก์ชันเวียนเกิด แต่เรารู้เพียงแค่ว่าสำหรับ ตัวสร้างฟังก์ชันเวียนเกิด <code>‹recursion-maker›</code> ใด ๆ จะได้ว่า <code>(Z ‹recursion-maker›)</code> จะกลายเป็นฟังก์ชันเวียนเกิด เราสามารถใช้ <code>‹recursion-maker›</code> ทำอย่างอื่นได้หรือไม่? เราจะพิจารณา <code>‹fact-maker›</code> เป็นตัวอย่าง</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre>1
2
3
4
5</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-31"><span></span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span>
  <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">n</span><span class="p">)</span></span>
    <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/case.html#(form._((lib._racket/private/more-scheme..rkt)._case))">case</a></span> <span class="n">n</span>
      <span class="paren"><span class="p">[</span><span class="paren"><span class="p">(</span><span class="mi">0</span><span class="p">)</span></span> <span class="mi">1</span><span class="p">]</span></span>
      <span class="paren"><span class="p">[</span><span class="k"><a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket/private/letstx-scheme..rkt)._else))">else</a></span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))">*</a></span> <span class="n">n</span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))">-</a></span> <span class="n">n</span> <span class="mi">1</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-31"><i class="far fa-copy"></i></button></div>
</div>
<div class="alert alert-primary" role="alert"><div class="h2"></div>
<p>บทความยังอยู่ในระหว่างการแปล</p>
</div><p>What can we pass into $\text{fact-maker}$? It obviously consumes the factorial function! But provided that we don’t have the real factorial function already, the best we can do is to provide any other value instead. Say, we pass in a non-sensible value $42$. This results in:</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre>1
2
3
4</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-32"><span></span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">n</span><span class="p">)</span></span>
  <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/case.html#(form._((lib._racket/private/more-scheme..rkt)._case))">case</a></span> <span class="n">n</span>
    <span class="paren"><span class="p">[</span><span class="paren"><span class="p">(</span><span class="mi">0</span><span class="p">)</span></span> <span class="mi">1</span><span class="p">]</span></span>
    <span class="paren"><span class="p">[</span><span class="k"><a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket/private/letstx-scheme..rkt)._else))">else</a></span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))">*</a></span> <span class="n">n</span> <span class="paren"><span class="p">(</span><mark class="highlight-focus"><span class="mi">42</span></mark> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))">-</a></span> <span class="n">n</span> <span class="mi">1</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span><span class="p">)</span></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-32"><i class="far fa-copy"></i></button></div>
</div>
<p>What we have here is the factorial function that only works on $n = 0$. For $n &gt; 0$, the highlighted $42$ will be used as a function value which results in an error. We will call this function $\text{fact}_0$.</p>
<p>What else can we pass into $\text{fact-maker}$? We just obtained $\text{fact}_0 = \text{fact-maker}(42)$, so we can use it. This results in:</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre>1
2
3
4</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-33"><span></span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">n</span><span class="p">)</span></span>
  <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/case.html#(form._((lib._racket/private/more-scheme..rkt)._case))">case</a></span> <span class="n">n</span>
    <span class="paren"><span class="p">[</span><span class="paren"><span class="p">(</span><span class="mi">0</span><span class="p">)</span></span> <span class="mi">1</span><span class="p">]</span></span>
    <span class="paren"><span class="p">[</span><span class="k"><a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket/private/letstx-scheme..rkt)._else))">else</a></span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))">*</a></span> <span class="n">n</span> <span class="paren"><span class="p">(</span><span class="n">‹fact0›</span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))">-</a></span> <span class="n">n</span> <span class="mi">1</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span><span class="p">)</span></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-33"><i class="far fa-copy"></i></button></div>
</div>
<p>Again, what we have here is the factorial function that works on $n \le 1$. Let’s call it $\text{fact}_1$. Next, we can pass $\text{fact}_1 = \text{fact-maker}(\text{fact-maker}(42))$ into $\text{fact-maker}$ to get $\text{fact}_2$. We can clearly see the trend here. $\text{fact-maker}^k(42) = \text{fact}_{k-1}$, the factorial function that works on $n \le k - 1$.</p>
<p>In general, any recursion maker $f$ propels the computation one more level deeper.</p>
<p>To get the actual factorial function, which should work for any natural number $n$, we evidently need an infinitely high tower of $\text{fact-maker}$. That is, $\text{fact} = \text{fact}_\infty = \text{fact-maker}(\text{fact-maker}(\text{fact-maker}(\dots)))$.</p>
<p>Note that:</p>
<p>$$\begin{align*}<br/>\text{fact} &amp;= \text{fact-maker}(\text{fact-maker}(\dots))\\<br/>\text{fact-maker}(\text{fact}) &amp;= \text{fact-maker}(\text{fact-maker}(\text{fact-maker}(\dots))) &amp; \text{applying fact-maker}\\<br/> &amp;= \text{fact}\\<br/>\end{align*}$$</p>
<p>which agrees with our definition of $\text{fact-maker}$: applying $\text{fact}$ to $\text{fact-maker}$ produces the actual $\text{fact}$ function.</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre>1
2
3
4
5</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-34"><span></span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span>
  <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">n</span><span class="p">)</span></span>
    <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/case.html#(form._((lib._racket/private/more-scheme..rkt)._case))">case</a></span> <span class="n">n</span>
      <span class="paren"><span class="p">[</span><span class="paren"><span class="p">(</span><span class="mi">0</span><span class="p">)</span></span> <span class="mi">1</span><span class="p">]</span></span>
      <span class="paren"><span class="p">[</span><span class="k"><a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket/private/letstx-scheme..rkt)._else))">else</a></span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))">*</a></span> <span class="n">n</span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))">-</a></span> <span class="n">n</span> <span class="mi">1</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-34"><i class="far fa-copy"></i></button></div>
</div>
<p>Recall that the Z combinator makes the recursion possible: $\text{fact} = Z(\text{fact-maker})$. Substituting this in the above equation, we obtain that $\text{fact-maker}(Z(\text{fact-maker})) = Z(\text{fact-maker})$.</p>
<p>In general, for any recursion maker $f$, $Z(f) = f(Z(f))$. The importance of this identity is that $Z(f) = f(Z(f)) = f(f(Z(f))) = f(f(f(Z(f)))) = \dots$ which creates an infinite tower of the recursion maker $f$, making recursion possible.</p>
<h3>Yet another proof</h3>
<p>We can also show that $Z(f) = f(Z(f))$ directly using the definition of $Z$:</p>
<p>$$\begin{align*}<br/>Z &amp;= \lam{f}{(\lam{x}{f (\lam{v}{(x x) v})})(\lam{x}{f (\lam{v}{(x x) v})})} &amp; \\<br/>Z(f) &amp;= (\lam{\color{red}{x}}{f (\lam{v}{(\color{red}{x x}) v})})(\lam{x}{f (\lam{v}{(x x) v})}) &amp; \\<br/>&amp;= f (\lam{\color{blue}{v}}{((\lam{x}{f (\lam{v}{(x x) v})}) (\lam{x}{f (\lam{v}{(x x) v})})) \color{blue}{v}}) &amp; \beta \text{-reduction}\\<br/>&amp;= f ((\lam{x}{f (\lam{v}{(x x) v})}) (\lam{x}{f (\lam{v}{(x x) v})})) &amp; \eta \text{-conversion}\\<br/>&amp;= f (Z(f)) &amp; \\<br/>\end{align*}$$</p>
<h2 id="Y-vs-Z">Y vs. Z <a class="self-ref" href="#Y-vs-Z">#</a></h2>
<p>How are <code>‹make-recursion›</code>, $Z$, and $Y$ different? We can empirically test them:</p>
<ul>
<li>
<p>The original <code>‹make-recursion›</code>:</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-35"><span></span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">make-recursion</span>
       <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">f</span><span class="p">)</span></span>
         <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">k</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">f</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">v</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span> <span class="n">v</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
                  <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">f</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">v</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span> <span class="n">v</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span> <span class="n">k</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
  <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">fact-maker</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span>
                      <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">n</span><span class="p">)</span></span>
                        <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/case.html#(form._((lib._racket/private/more-scheme..rkt)._case))">case</a></span> <span class="n">n</span>
                          <span class="paren"><span class="p">[</span><span class="paren"><span class="p">(</span><span class="mi">0</span><span class="p">)</span></span> <span class="mi">1</span><span class="p">]</span></span>
                          <span class="paren"><span class="p">[</span><span class="k"><a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket/private/letstx-scheme..rkt)._else))">else</a></span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))">*</a></span> <span class="n">n</span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))">-</a></span> <span class="n">n</span> <span class="mi">1</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
    <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="n">make-recursion</span> <span class="n">fact-maker</span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
      <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="mi">3</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="mi">4</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-35"><i class="far fa-copy"></i></button></div>
</div>
<div class="highlight-container"><div class="highlight"><pre id="output-id-11">30</pre>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#output-id-11"><i class="far fa-copy"></i></button></div>
</div>
</li>
<li>
<p>The Z combinator:</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-36"><span></span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">Z</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">f</span><span class="p">)</span></span>
           <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">f</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">v</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span> <span class="n">v</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
            <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">f</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">v</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span> <span class="n">v</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
  <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">fact-maker</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span>
                      <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">n</span><span class="p">)</span></span>
                        <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/case.html#(form._((lib._racket/private/more-scheme..rkt)._case))">case</a></span> <span class="n">n</span>
                          <span class="paren"><span class="p">[</span><span class="paren"><span class="p">(</span><span class="mi">0</span><span class="p">)</span></span> <span class="mi">1</span><span class="p">]</span></span>
                          <span class="paren"><span class="p">[</span><span class="k"><a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket/private/letstx-scheme..rkt)._else))">else</a></span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))">*</a></span> <span class="n">n</span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))">-</a></span> <span class="n">n</span> <span class="mi">1</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
    <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="n">Z</span> <span class="n">fact-maker</span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
      <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="mi">3</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="mi">4</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-36"><i class="far fa-copy"></i></button></div>
</div>
<div class="highlight-container"><div class="highlight"><pre id="output-id-12">30</pre>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#output-id-12"><i class="far fa-copy"></i></button></div>
</div>
</li>
<li>
<p>The Y combinator:</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-37"><span></span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">Y</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">f</span><span class="p">)</span></span>
           <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">f</span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
            <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">f</span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
  <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">fact-maker</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span>
                      <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">n</span><span class="p">)</span></span>
                        <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/case.html#(form._((lib._racket/private/more-scheme..rkt)._case))">case</a></span> <span class="n">n</span>
                          <span class="paren"><span class="p">[</span><span class="paren"><span class="p">(</span><span class="mi">0</span><span class="p">)</span></span> <span class="mi">1</span><span class="p">]</span></span>
                          <span class="paren"><span class="p">[</span><span class="k"><a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket/private/letstx-scheme..rkt)._else))">else</a></span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))">*</a></span> <span class="n">n</span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))">-</a></span> <span class="n">n</span> <span class="mi">1</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
    <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="n">Y</span> <span class="n">fact-maker</span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
      <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="mi">3</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="mi">4</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-37"><i class="far fa-copy"></i></button></div>
</div>
<div class="highlight-container"><div class="highlight"><pre id="output-id-13"><span class="text-type-timeout">Non-terminating</span></pre>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#output-id-13"><i class="far fa-copy"></i></button></div>
</div>
</li>
</ul>
<p>Uh oh.</p>
<p>We derive the Y combinator from the Z combinator via $\eta$-conversion, which intuitively should preserve semantics. Yet something clearly went wrong when we try to use the Y combinator for computing factorials, since the computation doesn’t terminate (while the Z combinator works as expected). In fact, the problem is much worse: any attempt to use <code>Y</code> will always result in an infinite loop in Racket!</p>
<p>Recall the following:</p>
<blockquote>if $e$ evaluates to a function of one argument, then $e$ is มีความหมายเทียบเท่า to $\lam{x}{e x}$ (provided that $x$ does not freely occur in $e$).</blockquote>
<p>and how we convert $Z$:</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre>1
2
3</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-38"><span></span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">f</span><span class="p">)</span></span>
  <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">f</span> <mark class="highlight-focus"><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">v</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span> <span class="n">v</span><span class="p">)</span></span><span class="p">)</span></span></mark><span class="p">)</span></span><span class="p">)</span></span>
   <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">f</span> <mark class="highlight-focus"><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">v</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span> <span class="n">v</span><span class="p">)</span></span><span class="p">)</span></span></mark><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-38"><i class="far fa-copy"></i></button></div>
</div>
<p>to $Y$:</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre>1
2
3</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-39"><span></span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">f</span><span class="p">)</span></span>
  <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">f</span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
   <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">f</span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-39"><i class="far fa-copy"></i></button></div>
</div>
<p>In Racket, when we evaluate, say, <code>(Y fact-maker)</code>, does <code>(x x)</code> evaluate to a function of one argument? We can manually step through the evaluation to see what’s going on:</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-40"><span></span><span class="mf">1.</span>  <span class="paren"><span class="p">(</span><mark class="highlight-focus"><span class="n">Y</span></mark> <span class="n">fact-maker</span><span class="p">)</span></span>
<span class="n">==&gt;</span> <span class="paren"><span class="p">(</span><mark class="highlight-add"><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">f</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">f</span> <mark class="highlight-super-focus"><span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span></mark><span class="p">)</span></span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">f</span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span></mark> <span class="n">fact-maker</span><span class="p">)</span></span>

<span class="mf">2.</span>  <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">f</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">f</span> <mark class="highlight-super-focus"><span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span></mark><span class="p">)</span></span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">f</span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span> <mark class="highlight-focus"><span class="n">fact-maker</span></mark><span class="p">)</span></span>
<span class="n">==&gt;</span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">f</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">f</span> <mark class="highlight-super-focus"><span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span></mark><span class="p">)</span></span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">f</span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span> <mark class="highlight-add"><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span> <span class="k"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._......))">...</a></span><span class="p">)</span></span></mark><span class="p">)</span></span>

<span class="mf">3.</span>  <mark class="highlight-focus"><span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">f</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">f</span> <mark class="highlight-super-focus"><span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span></mark><span class="p">)</span></span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">f</span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span> <span class="k"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._......))">...</a></span><span class="p">)</span></span><span class="p">)</span></span></mark>
<span class="n">==&gt;</span> <mark class="highlight-add"><span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span> <span class="k"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._......))">...</a></span><span class="p">)</span></span> <mark class="highlight-super-focus"><span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span></mark><span class="p">)</span></span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span> <span class="k"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._......))">...</a></span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span></mark>

<span class="mf">4.</span>  <mark class="highlight-focus"><span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span> <span class="k"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._......))">...</a></span><span class="p">)</span></span> <mark class="highlight-super-focus"><span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span></mark><span class="p">)</span></span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span> <span class="k"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._......))">...</a></span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span></mark>
<span class="n">==&gt;</span> <mark class="highlight-add"><span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span> <span class="k"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._......))">...</a></span><span class="p">)</span></span>
     <mark class="highlight-super-focus"><span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span> <span class="k"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._......))">...</a></span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span> <span class="k"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._......))">...</a></span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span></mark><span class="p">)</span></span></mark>

<span class="mf">5.</span>  <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span> <span class="k"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._......))">...</a></span><span class="p">)</span></span>
     <mark class="highlight-super-focus"><mark class="highlight-focus"><span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span> <span class="k"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._......))">...</a></span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span> <span class="k"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._......))">...</a></span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span></mark></mark><span class="p">)</span></span>
<span class="n">==&gt;</span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span> <span class="k"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._......))">...</a></span><span class="p">)</span></span>
     <mark class="highlight-super-focus"><mark class="highlight-add"><span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span> <span class="k"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._......))">...</a></span><span class="p">)</span></span>
      <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span> <span class="k"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._......))">...</a></span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span> <span class="k"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._......))">...</a></span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span></mark></mark><span class="p">)</span></span>

<span class="mf">6.</span>  <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span> <span class="k"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._......))">...</a></span><span class="p">)</span></span>
     <mark class="highlight-super-focus"><span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span> <span class="k"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._......))">...</a></span><span class="p">)</span></span>
      <mark class="highlight-focus"><span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span> <span class="k"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._......))">...</a></span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span> <span class="k"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._......))">...</a></span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span></mark><span class="p">)</span></span></mark><span class="p">)</span></span>
<span class="n">==&gt;</span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span> <span class="k"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._......))">...</a></span><span class="p">)</span></span>
     <mark class="highlight-super-focus"><span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span> <span class="k"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._......))">...</a></span><span class="p">)</span></span>
      <mark class="highlight-add"><span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span> <span class="k"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._......))">...</a></span><span class="p">)</span></span>
       <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span> <span class="k"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._......))">...</a></span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span> <span class="k"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._......))">...</a></span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span></mark><span class="p">)</span></span></mark><span class="p">)</span></span>

<span class="k"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._......))">...</a></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-40"><i class="far fa-copy"></i></button></div>
</div>
<p>The answer is no! Hence, in Racket, our $\eta$-conversion to turn $Z$ to $Y$ is unsound!</p>
<p>While Racket evaluates the term <code>(Y fact-maker)</code> exactly as described above, we can imagine another way to evaluate the term:</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-41"><span></span><span class="mf">1.</span>  <span class="paren"><span class="p">(</span><mark class="highlight-focus"><span class="n">Y</span></mark> <span class="n">fact-maker</span><span class="p">)</span></span>
<span class="n">==&gt;</span> <span class="paren"><span class="p">(</span><mark class="highlight-add"><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">f</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">f</span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">f</span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span></mark> <span class="n">fact-maker</span><span class="p">)</span></span>

<span class="mf">2.</span>  <mark class="highlight-focus"><span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">f</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">f</span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">f</span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span> <span class="n">fact-maker</span><span class="p">)</span></span></mark>
<span class="n">==&gt;</span> <mark class="highlight-add"><span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact-maker</span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact-maker</span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span></mark>

<span class="mf">3.</span>  <mark class="highlight-focus"><span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact-maker</span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact-maker</span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span></mark>
<span class="n">==&gt;</span> <mark class="highlight-add"><span class="paren"><span class="p">(</span><span class="n">fact-maker</span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact-maker</span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact-maker</span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span></mark>

<span class="mf">4.</span>  <span class="paren"><span class="p">(</span><mark class="highlight-focus"><span class="n">fact-maker</span></mark> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact-maker</span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact-maker</span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
<span class="n">==&gt;</span> <span class="paren"><span class="p">(</span><mark class="highlight-add"><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span> <span class="k"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._......))">...</a></span><span class="p">)</span></span></mark> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact-maker</span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact-maker</span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>

<span class="mf">5.</span>  <mark class="highlight-focus"><span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span> <span class="k"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._......))">...</a></span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact-maker</span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact-maker</span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span></mark>
<span class="n">==&gt;</span> <mark class="highlight-add"><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">n</span><span class="p">)</span></span>
      <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/case.html#(form._((lib._racket/private/more-scheme..rkt)._case))">case</a></span>
        <span class="paren"><span class="p">[</span><span class="paren"><span class="p">(</span><span class="mi">0</span><span class="p">)</span></span> <span class="mi">1</span><span class="p">]</span></span>
        <span class="paren"><span class="p">[</span><span class="mi">1</span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))">*</a></span> <span class="n">n</span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact-maker</span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact-maker</span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
                 <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))">-</a></span> <span class="n">n</span> <span class="mi">1</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span><span class="p">)</span></span></mark>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-41"><i class="far fa-copy"></i></button></div>
</div>
<p>In this evaluation trace, <code>(Y fact-maker)</code> successfully evaluates to the factorial function! The difference of these two evaluation traces is due to <a href="https://en.wikipedia.org/wiki/Evaluation_strategy"><dfn>evaluation strategies</dfn></a>, which describes <em>what reducible expression</em> (redex) should be $\beta$-reduced.</p>
<p>Most programming languages including Racket employ the first evaluation strategy presented above, which always evaluates arguments of a function application before the application itself. This strategy is known as <dfn>call-by-value</dfn><label for="margin-note-7" class="margin-note-toggle margin-note-number"></label><input type="checkbox" id="margin-note-7" class="margin-note-toggle"/><object class="margin-note"><div class="margin-note-box" decode="exclude-paragraph">The call-by-value strategy in fact is a family of strategies. It still leaves some room for flexibility. For example, the strategy does not specify which one between <code>((λ (x) x) 1)</code> and <code>((λ (x) x) 2)</code> should be reduced first when evaluating <code>(+ ((λ (x) x) 1) ((λ (x) x) 2))</code>. Racket particularly always evaluates the leftmost-innermost redex (outside of lambda functions) first.</div>
</object>.  As another example for how this strategy works, it would evaluate <code>(double (double 1))</code> where <code>double</code> is defined as <code>(λ (x) (+ x x))</code> in the following way:</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre>1
2
3
4</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-42"><span></span><span class="paren"><span class="p">(</span><span class="n">double</span> <mark class="highlight-focus"><span class="paren"><span class="p">(</span><span class="n">double</span> <span class="mi">1</span><span class="p">)</span></span></mark><span class="p">)</span></span> <span class="n">==&gt;</span> <span class="paren"><span class="p">(</span><span class="n">double</span> <mark class="highlight-add"><span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <span class="mi">1</span> <span class="mi">1</span><span class="p">)</span></span></mark><span class="p">)</span></span>
<span class="paren"><span class="p">(</span><span class="n">double</span> <mark class="highlight-focus"><span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <span class="mi">1</span> <span class="mi">1</span><span class="p">)</span></span></mark><span class="p">)</span></span>    <span class="n">==&gt;</span> <span class="paren"><span class="p">(</span><span class="n">double</span> <mark class="highlight-add"><span class="mi">2</span></mark><span class="p">)</span></span>
<mark class="highlight-focus"><span class="paren"><span class="p">(</span><span class="n">double</span> <span class="mi">2</span><span class="p">)</span></span></mark>          <span class="n">==&gt;</span> <mark class="highlight-add"><span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <span class="mi">2</span> <span class="mi">2</span><span class="p">)</span></span></mark>
<mark class="highlight-focus"><span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <span class="mi">2</span> <span class="mi">2</span><span class="p">)</span></span></mark>             <span class="n">==&gt;</span> <mark class="highlight-add"><span class="mi">4</span></mark>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-42"><i class="far fa-copy"></i></button></div>
</div>
<p>On the other hand, the second strategy presented above calls the function application without waiting for arguments to be evaluated first. This strategy is known as <dfn>call-by-name</dfn>. It would evaluate <code>(double (double 1))</code> in the following way:</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre>1
2
3
4
5
6</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-43"><span></span><mark class="highlight-focus"><span class="paren"><span class="p">(</span><span class="n">double</span> <span class="paren"><span class="p">(</span><span class="n">double</span> <span class="mi">1</span><span class="p">)</span></span><span class="p">)</span></span></mark>       <span class="n">==&gt;</span> <mark class="highlight-add"><span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <span class="paren"><span class="p">(</span><span class="n">double</span> <span class="mi">1</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">double</span> <span class="mi">1</span><span class="p">)</span></span><span class="p">)</span></span></mark>
<span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <mark class="highlight-focus"><span class="paren"><span class="p">(</span><span class="n">double</span> <span class="mi">1</span><span class="p">)</span></span></mark> <span class="paren"><span class="p">(</span><span class="n">double</span> <span class="mi">1</span><span class="p">)</span></span><span class="p">)</span></span> <span class="n">==&gt;</span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <mark class="highlight-add"><span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <span class="mi">1</span> <span class="mi">1</span><span class="p">)</span></span></mark> <span class="paren"><span class="p">(</span><span class="n">double</span> <span class="mi">1</span><span class="p">)</span></span><span class="p">)</span></span>
<span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <mark class="highlight-focus"><span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <span class="mi">1</span> <span class="mi">1</span><span class="p">)</span></span></mark> <span class="paren"><span class="p">(</span><span class="n">double</span> <span class="mi">1</span><span class="p">)</span></span><span class="p">)</span></span>    <span class="n">==&gt;</span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <mark class="highlight-add"><span class="mi">2</span></mark> <span class="paren"><span class="p">(</span><span class="n">double</span> <span class="mi">1</span><span class="p">)</span></span><span class="p">)</span></span>
<span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <span class="mi">2</span> <mark class="highlight-focus"><span class="paren"><span class="p">(</span><span class="n">double</span> <span class="mi">1</span><span class="p">)</span></span></mark><span class="p">)</span></span>          <span class="n">==&gt;</span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <span class="mi">2</span> <mark class="highlight-add"><span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <span class="mi">1</span> <span class="mi">1</span><span class="p">)</span></span></mark><span class="p">)</span></span>
<span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <span class="mi">2</span> <mark class="highlight-focus"><span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <span class="mi">1</span> <span class="mi">1</span><span class="p">)</span></span></mark><span class="p">)</span></span>             <span class="n">==&gt;</span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <span class="mi">2</span> <mark class="highlight-add"><span class="mi">2</span></mark><span class="p">)</span></span>
<mark class="highlight-focus"><span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <span class="mi">2</span> <span class="mi">2</span><span class="p">)</span></span></mark>                   <span class="n">==&gt;</span> <mark class="highlight-add"><span class="mi">4</span></mark>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-43"><i class="far fa-copy"></i></button></div>
</div>
<p>We have seen that different evaluation stategies might not evaluate a term to the same result. This is disconcerting. Fortunately, the <a href="https://en.wikipedia.org/wiki/Church%E2%80%93Rosser_theorem">Church-Rosser theorem</a> guarantees that given a term $t$, <em>if two strategies successfully evaluate $t$ to values</em>, then the two values from both strategies are equal, as we can see from the <code>(double (double 1))</code> example. The only case that two evaluation strategies would evaluate a term to different results is when one of them doesn’t terminate, which is exactly what happens with the Y combinator in the call-by-value strategy.</p>
<p>There are advantages and disadvantages for each evaluation strategies. For instance, the call-by-name strategy has a beautiful property that if a term could be evaluated to a value by <em>some</em> evaluation strategy, then it will be able to evaluate the term to the value as well. This is the reason why the strategy successfully evaluate <code>(Y fact-maker)</code>. The disadvantages are (1) it’s not really efficient, taking 6 steps to evaluate <code>(double (double 1))</code> while the call-by-value strategy can evaluate the term in only 4 steps, and (2) it doesn’t interact well with mutation, which is a feature that most programming languages have. This is the reason why most programming languages use call-by-value instead.</p>
<p>Due to the call-by-value strategy, we can’t run the Y combinator in the standard Racket language. One cool feature of Racket however is its ability to create and use a new programming language via <a href="https://docs.racket-lang.org/guide/more-hash-lang.html">the hash lang line</a>. In fact, the creators of Racket even call Racket <a href="https://cacm.acm.org/magazines/2018/3/225475-a-programmable-programming-language/fulltext">a Programmable Programming Language</a>. It is very easy to create a call-by-name language with Racket. Even better, someone did that already and we can just use it!</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-44"><span></span><span class="kn">#lang </span><span class="nn">lazy</span>

<span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">Y</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">f</span><span class="p">)</span></span>
           <span class="paren"><span class="p">(</span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">f</span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span>
            <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">x</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">f</span> <span class="paren"><span class="p">(</span><span class="n">x</span> <span class="n">x</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
  <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">fact-maker</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span><span class="p">)</span></span>
                      <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">n</span><span class="p">)</span></span>
                        <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/case.html#(form._((lib._racket/private/more-scheme..rkt)._case))">case</a></span> <span class="n">n</span>
                          <span class="paren"><span class="p">[</span><span class="paren"><span class="p">(</span><span class="mi">0</span><span class="p">)</span></span> <span class="mi">1</span><span class="p">]</span></span>
                          <span class="paren"><span class="p">[</span><span class="k"><a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket/private/letstx-scheme..rkt)._else))">else</a></span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._*))">*</a></span> <span class="n">n</span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))">-</a></span> <span class="n">n</span> <span class="mi">1</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
    <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">fact</span> <span class="paren"><span class="p">(</span><span class="n">Y</span> <span class="n">fact-maker</span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
      <span class="paren"><span class="p">(</span><span class="n">!</span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="mi">3</span><span class="p">)</span></span> <span class="paren"><span class="p">(</span><span class="n">fact</span> <span class="mi">4</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span> <span class="c1">;; we need to ! to force value for printing</span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-44"><i class="far fa-copy"></i></button></div>
</div>
<div class="highlight-container"><div class="highlight"><pre id="output-id-14">30</pre>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#output-id-14"><i class="far fa-copy"></i></button></div>
</div>
<p>The final remark in this section is that, the Z combinator is also known as <dfn>the call-by-value Y combinator</dfn> since it’s the Y combinator for call-by-value languages.</p>
<h2 id="Y-and-me">Y and me <a class="self-ref" href="#Y-and-me">#</a></h2>
<p>I learned the Y combinator two years ago from the <a href="https://cs.brown.edu/courses/cs173/">PL class</a> taught by <a href="https://cs.brown.edu/~sk/">Shriram Krishnamurthi</a>. One great explanation (which Shriram pointed us to) is <a href="http://felleisen.org/matthias/">Matthias Felleisen</a>’s <a href="https://xivilization.net/~marek/binaries/Y.pdf"><i>A Lecture of the Why of Y</i></a>, which similarly attempts to derive the Y combinator. However, the explanation that corresponds to the “Enabling recursion” section goes in a much slower pace and implicitly contains some elements from the “Fixed point” section. The strength of this approach in my opinion is that it crucially uses the fixed-point identity $Y(f) = f(Y(f))$ to justify the “self-application trick” in the derivation right away, so it motivates really well why $Y(f) = f(Y(f))$ is important. The approach that I use, on the other hand, simply focuses on where things are bound and how can we direct values to appropriate places, which results in a simpler explanation in my opinion. I also make use of <code>let</code> a lot, which I think helps with readability. The weakness is that I also need to talk about desugaring.</p>
<p>I didn’t discover this approach myself. The core insight of this approach is from a student’s homework that I graded in the <a href="https://cs.brown.edu/courses/cs173/2017/">current iteration</a> of the PL class. A part of the homework asks students to write random programs in a language that is very similar to Racket without <code>letrec</code> and mutation. I didn’t expect that students will be able to write a really meaningful program unless they know a fixed-point combinator already, ... or so I thought. It turns out that one student wrote a program to calculate 1 + 2 + ... + n for arbitrary n without knowing a fixed-point combinator! Here’s the program in Racket:</p>
<div class="highlight-container"><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv">
<pre>1
2
3
4
5</pre>
</div>
</td><td class="code"><div class="source"><pre class="racket" id="code-id-45"><span></span><span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))">let</a></span> <span class="paren"><span class="p">(</span><span class="paren"><span class="p">[</span><span class="n">triangle</span> <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))">λ</a></span> <span class="paren"><span class="p">(</span><span class="n">triangle</span> <span class="n">n</span><span class="p">)</span></span>
                  <span class="paren"><span class="p">(</span><span class="k"><a href="http://docs.racket-lang.org/reference/case.html#(form._((lib._racket/private/more-scheme..rkt)._case))">case</a></span> <span class="n">n</span>
                    <span class="paren"><span class="p">[</span><span class="paren"><span class="p">(</span><span class="mi">0</span><span class="p">)</span></span> <span class="mi">0</span><span class="p">]</span></span>
                    <span class="paren"><span class="p">[</span><span class="k"><a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket/private/letstx-scheme..rkt)._else))">else</a></span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))">+</a></span> <span class="n">n</span> <span class="paren"><span class="p">(</span><span class="n">triangle</span> <span class="n">triangle</span> <span class="paren"><span class="p">(</span><span class="nb"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#(def._((quote._~23~25kernel)._-))">-</a></span> <span class="n">n</span> <span class="mi">1</span><span class="p">)</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span><span class="p">)</span></span><span class="p">]</span></span><span class="p">)</span></span>
  <span class="paren"><span class="p">(</span><span class="n">triangle</span> <span class="n">triangle</span> <span class="mi">10</span><span class="p">)</span></span><span class="p">)</span></span>
</pre>
</div>
</td></tr></tbody></table>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#code-id-45"><i class="far fa-copy"></i></button></div>
</div>
<div class="highlight-container"><div class="highlight"><pre id="output-id-15">55</pre>
</div>
<div class="copy-button"><button type="button" class="btn btn-outline-secondary btn-sm" data-clipboard-target="#output-id-15"><i class="far fa-copy"></i></button></div>
</div>
<p>Granted, this is simply a rewrite of one of Matthias’s slides into the <code>let</code> form with uncurrying, but it really opened up my eyes.</p>
<h2 id="Acknowledgements">Acknowledgements <a class="self-ref" href="#Acknowledgements">#</a></h2>
<p>Since our grading policy dictates that we can’t look at students’ name, I don’t know who this student is. Regardless, I would like to thank them for this incredible insight. I also would like to thank Shriram and Matthias for their teaching. Lastly, I thank <a href="https://homes.cs.washington.edu/~jrw12/">James Wilcox</a> for his various suggestions for this post.</p>
</div>
</p>
</div>
</div>
<footer><hr/><div class="float-md-left">เว็บไซต์สร้างด้วย <a href="http://pollenpub.com">Pollen</a> / <a href="https://racket-lang.org">Racket</a></div>
<div class="float-md-right">© สรวีย์ พรเจริญวาสน์</div>
</footer>
</main>
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script src="https://homes.cs.washington.edu/~sorawee/static/js/bootstrap.bundle.min.js"></script><script src="https://homes.cs.washington.edu/~sorawee/static/js/script.js"></script></body>
</html>